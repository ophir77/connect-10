(window.webpackJsonp=window.webpackJsonp||[]).push([[36],{"6HxN":function(e,t,a){"use strict";a.r(t);var i=a("Q7RW"),r=a("L2JU"),o=a("PCDP"),s=a("4qCA"),n=a.n(s),l=a("aX5J"),u=a.n(l),c=a("KLsy"),d=a.n(c),f=a("7RU4"),g=a.n(f),p=a("m/Fr"),m=a.n(p),h=a("hyU+"),b=a.n(h);function v(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?v(Object(a),!0).forEach((function(t){O(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):v(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function O(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var C={components:{ImageUploader:i.a},data:function(){return{uuid:null,user:null,isLoading:!1}},computed:y({},Object(r.c)("config",["configs","vars"])),methods:y({},Object(r.b)("common",["Init","Get"]),{handleUploadError:function(e){this.$toasted.error(e,this.$toastConfig.error)},getUserImage:function(e,t){if(!e)return m.a;if("male"===e.uuid){if(t){if(t.years<13)return n.a;if(t.years<18)return d.a}return m.a}if(t){if(t.years<13)return u.a;if(t.years<18)return g.a}return b.a},getInitialData:function(){var e=this;this.isLoading=!0,this.Get(this.uuid).then((function(t){e.user=t,e.isLoading=!1})).catch((function(t){e.isLoading=!1,e.formErrors=o.handleErrors(t)}))}}),mounted:function(){this.$route.params.uuid&&(this.uuid=this.$route.params.uuid),this.Init({url:"users"}),this.getInitialData()},beforeRouteEnter:function(e,t,a){e.params.uuid?a():a({name:"appUserList"})}},_=a("KHd+"),U=Object(_.a)(C,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("base-container",{attrs:{boxed:"","with-loader":"","is-loading":e.isLoading,"loader-color":e.vars.loaderColor}},[e.user?a("div",{staticClass:"row"},[a("div",{staticClass:"col-12"},[a("h4",{staticClass:"text-center mb-5"},[e._v(e._s(e.$t("global.upload",{attribute:e.$t("user.props.image")}))+" for "+e._s(e.user.fullName))])]),e._v(" "),a("div",{staticClass:"col-12 col-md-4 offset-md-4 d-flex justify-content-center"},[a("image-uploader",{attrs:{url:"/users/"+e.user.uuid+"/image","name-label":"user.props.image","existing-image":e.user.image,placeholder:e.getUserImage(e.user.gender,e.user.age),"remove-from-server":"",profile:""},on:{uploaded:e.getInitialData,removed:e.getInitialData}})],1)]):e._e(),e._v(" "),a("div",{staticClass:"form-footer mt-5"},[a("div",{staticClass:"left-side"},[a("base-button",{attrs:{type:"button",design:"light",tabindex:"-1"},on:{click:function(t){return e.$router.back()}}},[a("i",{staticClass:"fas fa-chevron-left"}),e._v(" "+e._s(e.$t("general.back")))])],1)])])}),[],!1,null,null,null);t.default=U.exports},CL1i:function(e,t,a){(e.exports=a("I1BE")(!1)).push([e.i,".progress-ring-wrapper {\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(255, 255, 255, 0.7);\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding-bottom: 2.5rem;\n}",""])},ICll:function(e,t,a){"use strict";a.d(t,"d",(function(){return r})),a.d(t,"b",(function(){return o})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return n}));var i=a("5TL6");function r(e,t){return Object(i.a)({url:e.url,method:"post",data:e.data,upload:!0,config:{headers:{"Content-Type":"multipart/form-data"}},headers:{"Content-Type":"multipart/form-data; charset=utf-8; boundary="+Math.random().toString().substr(2)},onUploadProgress:t})}function o(e){return Object(i.a)({url:e.url,method:"delete",data:e.data})}function s(e,t,a){return Object(i.a)({url:e.url,method:"post",data:e.data,upload:!0,config:{headers:{"Content-Type":"multipart/form-data"}},headers:{"Content-Type":"multipart/form-data; charset=utf-8; boundary="+Math.random().toString().substr(2)},onUploadProgress:t,cancelToken:a})}function n(e){return Object(i.a)({url:e.url,method:"delete",data:e.data})}},Q7RW:function(e,t,a){"use strict";var i=a("BcCH"),r=a("ICll"),o=a("L2JU");function s(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,i)}return a}function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l={name:"image-uploader",props:{existingImage:{type:String,default:""},existingMedia:{type:Object,default:null},placeholder:{type:String,default:"https://via.placeholder.com/200/e1e2e4/b1b2b4/?text=Upload%20Image"},url:{type:String,required:!0},buttonColor:{type:String,default:"primary"},actionLabel:{type:String,default:"global.choose"},nameLabel:{type:String,default:"upload.image"},darkBg:{type:Boolean,default:!1},profile:{type:Boolean,default:!1},showUploadButton:{type:Boolean,default:!0},removeButton:{type:Boolean,default:!0},removeFromServer:{type:Boolean,default:!0},showProgress:{type:Boolean,default:!0},size:{type:String,default:""},fieldName:{type:String,default:"file"}},data:function(){return{isLoading:!1,imageRemoved:!1,uploadedImage:"",imageToUpload:"",actionLabelUpdated:"",files:[]}},computed:function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?s(Object(a),!0).forEach((function(t){n(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):s(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}({},Object(o.c)("config",["configs","vars"]),{imageSource:function(){var e=this.imageToUpload?this.imageToUpload:this.uploadedImage?this.uploadedImage:this.existingImage?this.existingImage:"";return e||this.placeholder},computedActionLabel:function(){return this.existingImage||this.uploadedImage?"global.change":this.actionLabel},showWhileUploading:function(){return this.imageToUpload&&this.files[0]&&"uploading"===this.files[0].status}}),methods:{generateImagePreview:function(e){this.isLoading=!0;for(var t=this.$refs.file.files,a=/(\.jpg|\.jpeg|\.png|\.gif)$/i,i=0;i<t.length;i++)a.exec(t[i].name)?this.files.push({uuid:uuid(),file:t[i],status:"waiting",progress:0}):(this.isLoading=!1,this.$toasted.error(this.$t("general.file_not_supported"),this.$toastConfig.error));this.files.length?this.createImage(this.files[0].file):this.isLoading=!1},createImage:function(e){var t=this,a=new FileReader;a.onload=function(e){t.imageToUpload=e.target.result},a.readAsDataURL(e),this.isLoading=!1},cancelUpload:function(){this.files=[],this.imageToUpload=""},uploadImage:function(){var e=this,t=this.files[0];t.status="waiting";var a=new FormData;this.files[0].size>this.configs.system.postMaxSize?this.$toasted.error(this.t("general.file_too_large"),this.$toastConfig.error):(a.append(this.fieldName,this.files[0].file),t.status="uploading",r.d({url:this.url,data:a},(function(e){t.progress=Math.round(100*e.loaded/e.total)})).then((function(a){t.status="uploaded",delete t.cancel,e.$toasted.success(a.message,e.$toastConfig.success),e.imageToUpload="",e.files=[],e.uploadedImage=a.image,e.$emit("uploaded",a.image)})).catch((function(a){t.status="error",e.$emit("error",a),formUtil.handleErrors(a)})))},removeImage:function(){var e=this;this.removeFromServer?formUtil.confirmAction().then((function(t){t.value&&(e.isLoading=!0,r.b({url:e.url}).then((function(t){e.$toasted.success(t.message,e.$toastConfig.success),e.imageRemoved=!0,e.uploadedImage="",e.$emit("removed"),e.isLoading=!1})).catch((function(t){e.isLoading=!1,e.formErrors=formUtil.handleErrors(t)})))})):(this.imageRemoved=!0,this.uploadedImage="",this.$emit("removed"))},startUpload:function(){this.files.length?this.uploadImage():this.$emit("noNeed")}},mounted:function(){i.a.$off("START_UPLOAD",this.startUpload),i.a.$on("START_UPLOAD",this.startUpload),i.a.$off("CANCEL_UPLOAD",this.cancelUpload),i.a.$on("CANCEL_UPLOAD",this.cancelUpload),this.uploadButtonText=this.label},destroyed:function(){i.a.$off("START_UPLOAD",this.startUpload),i.a.$off("CANCEL_UPLOAD",this.cancelUpload)}},u=(a("fPNp"),a("KHd+")),c=Object(u.a)(l,(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{class:["sm-uploader image-uploader",e.size]},[a("animated-loader",{attrs:{"is-loading":e.isLoading||!e.showProgress&&e.showWhileUploading,"loader-color":e.vars.loaderColor}}),e._v(" "),e.showProgress&&e.showWhileUploading?a("div",{staticClass:"progress-ring-wrapper"},[a("progress-ring",{attrs:{value:e.files[0].progress,"stroke-color":e.vars.loaderColor}})],1):e._e(),e._v(" "),e.imageSource?a("div",{class:["image-display-wrapper",{"dark-bg":e.darkBg}]},[a("div",{class:["image-display",{"image-profile":e.profile}]},[a("img",{staticClass:"img-responsive",attrs:{src:e.imageSource}})]),e._v(" "),e.imageToUpload?a("div",{staticClass:"submit-actions"},[a("base-button",{attrs:{type:"button",design:"light",size:"sm"},on:{click:e.cancelUpload}},[a("i",{staticClass:"fas fa-times"}),e._v(" "+e._s(e.$t("general.cancel")))]),e._v(" "),e.showUploadButton?a("base-button",{attrs:{type:"button",design:"success",size:"sm"},on:{click:e.uploadImage}},[a("i",{staticClass:"fas fa-arrow-circle-right"}),e._v(" "+e._s(e.$t("general.upload")))]):a("base-button",{attrs:{type:"button",design:e.buttonColor,size:"sm"}},[a("i",{staticClass:"far fa-image"}),e._v(" "+e._s(e.$t("global.change",{attribute:e.$t(e.nameLabel)})))])],1):e._e()]):e._e(),e._v(" "),e.imageToUpload?e._e():a("div",{staticClass:"image-uploader-form"},[e.existingImage&&e.removeButton?a("div",{staticClass:"existing-image-actions"},[a("base-button",{attrs:{type:"button",design:"danger",size:"sm"},on:{click:e.removeImage}},[a("i",{staticClass:"fas fa-trash"}),e._v(" "+e._s(e.$t("general.remove")))])],1):e._e(),e._v(" "),a("div",{staticClass:"file-selector"},[a("label",{class:"btn btn-"+e.buttonColor+" btn-sm"},[a("input",{ref:"file",staticClass:"selector-input",attrs:{name:"file",type:"file",id:"file",accept:"image/*"},on:{change:e.generateImagePreview}}),e._v(" "),e._m(0),e._v(" "),a("span",{staticClass:"button-label"},[e._v(e._s(e.$t(e.computedActionLabel,{attribute:e.$t(e.nameLabel)})))])])])])],1)}),[function(){var e=this.$createElement,t=this._self._c||e;return t("span",{staticClass:"button-icon"},[t("i",{staticClass:"fas fa-upload"})])}],!1,null,null,null);t.a=c.exports},fPNp:function(e,t,a){"use strict";var i=a("oq77");a.n(i).a},oq77:function(e,t,a){var i=a("CL1i");"string"==typeof i&&(i=[[e.i,i,""]]);var r={hmr:!0,transform:void 0,insertInto:void 0};a("aET+")(i,r);i.locals&&(e.exports=i.locals)}}]);
//# sourceMappingURL=view.js.map?id=a0ef9ed98eab9d8babff